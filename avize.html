<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <title>Aviz de ÃnsoÈ›ire a MÄƒrfii PNRAS</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        /* ConfiguraÈ›ie StrictÄƒ A4 */
        @page { 
            size: A4; 
            margin: 0; /* Marginile sunt gestionate de .sheet pentru consistenÈ›Äƒ ecran/print */
        }
        
        body { 
            margin: 0; 
            padding: 0; 
            background: #555; /* Fundal gri pentru a scoate Ã®n evidenÈ›Äƒ foaia */
            font-family: "Times New Roman", Times, serif; 
            font-size: 12pt;
            line-height: 1.15;
            color: #000;
        }

        /* Containerul Paginii - SimuleazÄƒ foaia A4 Ã®n browser */
        .sheet {
            background: white;
            width: 210mm;
            height: 297mm;
            margin: 20px auto; /* Centrare pe ecran */
            position: relative;
            box-sizing: border-box;
            padding: 1.5cm; /* Marginea de 1.5 cm solicitatÄƒ */
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        .antet-img { 
            width: 100%; 
            height: auto; 
            margin-bottom: 10px; 
        }

        .table-header-info { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
        .table-header-info td { width: 50%; vertical-align: top; border: 1px solid #000; padding: 10px; font-size: 11pt; }

        .titlu-central { text-align: center; font-weight: bold; font-size: 14pt; margin-top: 5px; text-transform: uppercase; }
        .serie-data-container { text-align: center; font-size: 14pt; font-weight: normal; margin: 15px 0 20px 0; line-height: 1.3; }
        .input-caseta { border: none; outline: none; font-family: "Times New Roman", Times, serif; font-size: 14pt; width: 45px; text-align: center; background: transparent; }

        .tabel-produse { width: 100%; border-collapse: collapse; margin-bottom: 25px; }
        .tabel-produse th, .tabel-produse td { border: 1px solid #000; padding: 8px; text-align: center; font-size: 10pt; vertical-align: middle; }
        .tabel-produse th { background: #f2f2f2; font-weight: bold; }
        .col-spec { text-align: center !important; line-height: 1.2; }

        .sectiune-text { font-size: 11pt; margin-bottom: 15px; }
        .sectiune-text strong { display: block; margin-bottom: 5px; text-decoration: underline; }
        .sectiune-text p { margin: 2px 0; padding-left: 15px; }

        .semnaturi { display: flex; justify-content: space-between; margin-top: 40px; font-size: 11pt; }
        .semnatura-box { width: 45%; text-align: center; }

        /* Footer fixat la 1.5cm de marginea de jos a foii */
        .footer { 
            position: absolute;
            bottom: 1.5cm;
            left: 1.5cm;
            right: 1.5cm;
            border-top: 1px solid #ccc;
            padding-top: 5px;
            text-align: center;
            font-size: 9pt;
            color: #333;
        }
        .footer a { color: #333; text-decoration: none; }
        
        .no-print { position: fixed; top: 20px; left: 20px; z-index: 1000; }
        button { padding: 10px 20px; cursor: pointer; background: #10b981; border: none; color: white; border-radius: 4px; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.3); }

        @media print { 
            body { background: none; } 
            .sheet { margin: 0; box-shadow: none; width: 210mm; height: 297mm; } 
            .no-print { display: none; } 
        }
    </style>
</head>
<body>

    <div class="no-print">
        <button onclick="window.print()">ğŸ–¨ï¸ PRINTEAZÄ‚ DOCUMENT</button>
        <button onclick="history.back()" style="background:#333; margin-left:10px;">ÃNAPOI</button>
    </div>

    <div class="sheet">
        <img src="antet_pnras.jpeg" alt="Antet PNRAS" class="antet-img">

        <table class="table-header-info">
            <tr>
                <td>
                    <strong>Furnizor: SC PROCONS IAÈ˜I SRL</strong><br>
                    Nr. ord. reg. com.: J22/294/23.02.2015<br>
                    C.U.I.: 34138254<br>
                    Sat BelceÈ™ti, Nr. 370, JudeÈ›ul IaÈ™i
                </td>
                <td>
                    <strong>Beneficiar: Liceul Tehnologic â€Victor MihÄƒilescu Craiuâ€ BelceÈ™ti</strong><br>
                    C.U.I.: 17130374<br>
                    Comuna BelceÈ™ti, Str. PrincipalÄƒ, Nr. 1, JudeÈ›ul IaÈ™i
                </td>
            </tr>
        </table>

        <div class="titlu-central">AVIZ DE ÃNSOÈšIRE A MÄ‚RFII</div>
        
        <div class="serie-data-container">
            <div>Nr. <input type="text" class="input-caseta" maxlength="3" placeholder="___"></div>
            <div>Data: <span id="data-automata"></span></div>
        </div>
        
        <table class="tabel-produse">
            <thead>
                <tr>
                    <th style="width: 5%;">Nr. crt.</th>
                    <th style="width: 50%;">SpecificaÈ›ia</th>
                    <th style="width: 8%;">U.M.</th>
                    <th style="width: 10%;">Cantitate</th>
                    <th style="width: 12%;">PreÈ› unitar<br>(fÄƒrÄƒ T.V.A.)</th>
                    <th style="width: 15%;">Valoare (lei)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td class="col-spec" id="spec-meniu">Se Ã®ncarcÄƒ...</td>
                    <td>buc.</td>
                    <td id="cantitate-celula">0</td>
                    <td>13,8</td>
                    <td id="valoare-totala">0</td>
                </tr>
            </tbody>
        </table>

        <div class="sectiune-text">
            <strong>MenÈ›iuni:</strong>
            <p>1. Produsele sunt livrate conform contractului de prestÄƒri servicii de catering Nr. 143/06.12.2024;</p>
            <p>2. Produsele sunt conforme din punct de vedere sanitar-veterinar;</p>
            <p>3. Avizul Ã®nsoÈ›eÈ™te marfa pe durata transportului;</p>
        </div>

        <div class="sectiune-text">
            <strong>Date privind expediÈ›ia:</strong>
            <p>1. Numele delegatului: Murariu Mirela; C.I. Seria MZ, Nr. 710839</p>
            <p>2. Expedierea s-a efectuat Ã®n prezenÈ›a noastrÄƒ la data de <span id="data-expeditie"></span>, ora 13.30.</p>
        </div>

        <div class="semnaturi">
            <div class="semnatura-box">
                SemnÄƒtura È™i È™tampila furnizorului,<br><br><br>
                _______________________
            </div>
            <div class="semnatura-box">
                SemnÄƒtura de primire,<br>
                <strong>Liceul Tehnologic â€Victor MihÄƒilescu Craiuâ€</strong><br>
                <strong>BelceÈ™ti</strong><br><br>
                <strong>Pavel Ioan</strong><br>
                _______________________
            </div>
        </div>

        <div class="footer">
            â€PNRR. FinanÈ›at de Uniunea EuropeanÄƒ â€“ UrmÄƒtoareaGeneraÈ›ieUEâ€<br>
            <a href="https://mfe.gov.ro/pnrr/">https://mfe.gov.ro/pnrr/</a> | <a href="https://www.facebook.com/PNRROficial/">https://www.facebook.com/PNRROficial/</a>
        </div>
    </div>

    <script>
        const URL_S = 'https://aexjrbdgajurxzngfkpx.supabase.co';
        const KEY_S = 'sb_publishable_KPV__0BA9z4EvRl5eqC0FQ_hmBLOLYv';
        const supabaseClient = supabase.createClient(URL_S, KEY_S);

        const params = new URLSearchParams(window.location.search);
        const zi = params.get('zi'), lunaText = params.get('luna'), an = params.get('an');

        const meniuriConfig = {
            1: "<strong>Meniu 1: È˜niÈ›el de pui cu garniturÄƒ, salatÄƒ È™i pÃ¢ine</strong><br>Carne: È™niÈ›el de pui (>130 g) | GarniturÄƒ: cartofi la cuptor/piure (>150 g)<br>SalatÄƒ: salatÄƒ de varzÄƒ | PÃ¢ine: 3 felii | Ambalaj È™i tacÃ¢muri",
            2: "<strong>Meniu 2: PulpÄƒ de pui cu garniturÄƒ, salatÄƒ È™i pÃ¢ine</strong><br>Carne: pulpÄƒ de pui la cuptor (>130 g) | GarniturÄƒ: orez legume/cartofi (>150 g)<br>SalatÄƒ: salatÄƒ varzÄƒ/asortatÄƒ | PÃ¢ine: 3 felii | Ambalaj È™i tacÃ¢muri",
            3: "<strong>Meniu 3: Hamburger de pui</strong><br>Carne: burger de pui (>130 g) | GarniturÄƒ: cartofi pai (>150 g)<br>SalatÄƒ: legume | PÃ¢ine: chiflÄƒ | Ambalaj È™i tacÃ¢muri",
            4: "<strong>Meniu 4: Piept de pui cu garniturÄƒ, salatÄƒ È™i pÃ¢ine</strong><br>Carne: piept pui (>130 g) | GarniturÄƒ: natur/piure (>150 g)<br>SalatÄƒ: varzÄƒ/asortatÄƒ | PÃ¢ine: 3 felii | Ambalaj È™i tacÃ¢muri",
            5: "<strong>Meniu 5: MÃ¢ncare cartofi cu carne porc, murÄƒturi È™i pÃ¢ine</strong><br>Carne: porc (>130 g) | GarniturÄƒ: mÃ¢ncÄƒricÄƒ cartofi (>150 g)<br>SalatÄƒ: murÄƒturi asortate | PÃ¢ine: 3 felii | Ambalaj È™i tacÃ¢muri"
        };

        const luniMapping = { "Ianuarie":"01","Februarie":"02","Martie":"03","Aprilie":"04","Mai":"05","Iunie":"06","Iulie":"07","August":"08","Septembrie":"09","Octombrie":"10","Noiembrie":"11","Decembrie":"12" };

        async function loadData() {
            const dataF = `${zi.padStart(2,'0')}.${luniMapping[lunaText]}.${an}`;
            document.getElementById('data-automata').innerText = dataF;
            document.getElementById('data-expeditie').innerText = dataF;

            const { data } = await supabaseClient.from('setari_pontaj').select('*').match({ zi, luna: lunaText, an }).single();

            if (data) {
                const cantitate = parseInt(data.valoare_aviz) || 0;
                const totalVal = (cantitate * 13.8).toFixed(2);
                document.getElementById('spec-meniu').innerHTML = meniuriConfig[data.tip_meniu] || "Meniu nespecificat";
                document.getElementById('cantitate-celula').innerText = cantitate;
                document.getElementById('valoare-totala').innerText = totalVal;
            }
        }
        loadData();
    </script>
</body>
</html>