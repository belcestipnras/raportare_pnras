<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <title>Dosar Lunar PNRAS - Complet</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        @page { size: A4; margin: 1.5cm; }
        body { margin: 0; padding: 0; background: #555; font-family: "Times New Roman", Times, serif; font-size: 12pt; line-height: 1.3; color: #000; }
        
        .sheet {
            background: white; width: 210mm; min-height: 297mm; margin: 20px auto;
            box-sizing: border-box; padding: 1.5cm; display: flex; flex-direction: column;
            box-shadow: 0 0 15px rgba(0,0,0,0.5); page-break-after: always;
        }

        .main-table { width: 100%; border-collapse: collapse; border: none; }
        .main-table td { border: none; padding: 0; vertical-align: top; }
        .antet-img { width: 100%; height: auto; margin-bottom: 10px; }

        .nr-inregistrare { margin-bottom: 20px; }
        .input-nr { border: none; outline: none; font-family: inherit; font-size: 12pt; width: 35px; text-align: center; background: transparent; border-bottom: 1px dotted #000; }
        .input-data { border: none; outline: none; font-family: inherit; font-size: 12pt; width: 100px; background: transparent; border-bottom: 1px dotted #000; }

        .titlu-doc { text-align: center; font-weight: bold; font-size: 14pt; margin: 5px 0; text-transform: uppercase; }
        .subtitlu { text-align: center; font-weight: bold; font-size: 13pt; margin-bottom: 15px; }

        .alineat { text-align: justify; text-indent: 1.5cm; margin-bottom: 8px; }
        .lista-criterii { margin: 5px 0 10px 0; padding-left: 2.5cm; text-align: justify; }

        .data-table { width: 100%; border-collapse: collapse; margin-top: 10px; table-layout: fixed; }
        .data-table th, .data-table td { border: 1px solid #000; padding: 5px; text-align: center; font-size: 9pt; }
        .data-table th { background: #f2f2f2; font-weight: bold; }
        
        .col-nr { width: 7%; }
        .col-data { width: 13%; }
        .col-spec { width: 50%; text-align: left !important; }
        .col-portii { width: 15%; }

        .keep-with-next { page-break-after: avoid; }

        .section-signatures { page-break-inside: avoid; margin-top: 20px; }
        .semnaturi-raport { display: flex; justify-content: space-between; margin-top: 25px; }
        .box-semnatura { width: 32%; text-align: center; font-size: 10.5pt; vertical-align: top; }

        .comisie-centrata { text-align: center; width: 100%; margin-top: 20px; }
        .membru-pv { margin-bottom: 15px; display: block; font-size: 11pt; }
        .linie-semnatura { margin-top: 5px; border-top: 1px solid #000; width: 220px; margin-left: auto; margin-right: auto; }

        .footer-content { text-align: center; font-size: 9pt; color: #333; border-top: 1px solid #ccc; padding-top: 8px; width: 100%; background: white; margin-top: auto; }

        .no-print { position: fixed; top: 20px; left: 20px; z-index: 1000; display: flex; gap: 10px; }
        .btn-print { padding: 10px 20px; background: #10b981; color: white; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; }
        .btn-back { padding: 10px 20px; background: #333; color: white; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; text-decoration: none; }

        @media print {
            body { background: none; }
            .sheet { margin: 0; box-shadow: none; width: 100%; padding: 0; height: auto; }
            .no-print { display: none; }
            tfoot { display: table-footer-group; }
            .footer-content { position: fixed; bottom: 0; left: 0; }
        }
    </style>
</head>
<body>

<div class="no-print">
    <button class="btn-print" onclick="window.print()">ğŸ–¨ï¸ PRINTEAZÄ‚ DOSAR</button>
    <button class="btn-back" onclick="history.back()">â¬…ï¸ ÃNAPOI</button>
</div>

<div class="sheet">
    <img src="antet_pnras.jpeg" class="antet-img">
    <div class="nr-inregistrare">Nr. Ã®nregistrare: <input type="text" class="input-nr"> / <input type="text" class="input-data" placeholder="__.__.2025"></div>
    <div class="titlu-doc">Raport lunar de distribuire a pachetului alimentar de tip masÄƒ caldÄƒ</div>
    <div class="subtitlu"><span class="luna-nume">...</span> <span class="an-nume">...</span></div>

    <p class="alineat">Ãn luna <span class="luna-text-mic">...</span> <span class="an-nume">...</span> pachetul alimentar de tip masÄƒ caldÄƒ a fost distribuit la activitÄƒÈ›ile remediale È™i extracurriculare, Ã®n funcÈ›ie de urmÄƒtoarele criterii:</p>
    <ol class="lista-criterii">
        <li>Disponibilitatea agentului economic de a asigura masÄƒ caldÄƒ Ã®n anumite zile;</li>
        <li>NumÄƒrul de ore de activitÄƒÈ›i remediale sau activitÄƒÈ›i extracurriculare din fiecare zi;</li>
        <li>NumÄƒrul de elevi din grupul-È›intÄƒ care È™i-au manifestat disponibilitatea de a participa la activitÄƒÈ›ile extracurriculare.</li>
    </ol>
    <p class="alineat">Meniurile distribuite elevilor au fost trecute Ã®n avizele de Ã®nsoÈ›ire a mÄƒrfii, dupÄƒ cum urmeazÄƒ:</p>

    <table class="data-table">
        <thead>
            <tr><th class="col-nr">Nr.</th><th class="col-data">Data</th><th class="col-spec">Tip meniu È™i specificaÈ›ii</th><th class="col-portii">PorÈ›ii Primite</th><th class="col-portii">PorÈ›ii Aviz</th></tr>
        </thead>
        <tbody id="tbody-raport"></tbody>
    </table>

    <div class="section-signatures">
        <div class="semnaturi-raport">
            <div class="box-semnatura"><strong>Ãntocmit,</strong><br><br>Pavel Ioan<br><br>_________________</div>
            <div class="box-semnatura"><strong>Avizat,</strong><br>Manager proiect,<br>prof. dr. Ciprian MIHAI<br><br>_________________</div>
            <div class="box-semnatura"><strong>Aprobat,</strong><br>Director,<br>prof. CÄƒtÄƒlin-IonuÈ› BAZILUC<br><br>_________________</div>
        </div>
    </div>
    <div class="footer-content">â€PNRR. FinanÈ›at de Uniunea EuropeanÄƒ â€“ UrmÄƒtoareaGeneraÈ›ieUEâ€<br>https://mfe.gov.ro/pnrr/</div>
</div>

<div class="sheet">
    <img src="antet_pnras.jpeg" class="antet-img">
    <div class="nr-inregistrare">Nr. Ã®nregistrare: <input type="text" class="input-nr"> / <input type="text" class="input-data" placeholder="__.__.2025"></div>
    <div class="titlu-doc">Proces verbal de recepÈ›ie</div>
    <div class="subtitlu">Luna: <span class="luna-nume">...</span> <span class="an-nume">...</span></div>

    <p style="text-align:center; font-weight:bold; margin-bottom:10px;">AchiziÈ›ia de pachet alimentar de tip masÄƒ caldÄƒ, pentru activitÄƒÈ›ile remediale È™i extracurriculare</p>
    
    <p class="alineat">Pachetul alimentar a fost livrat Ã®n luna <span class="luna-text-mic">...</span> <span class="an-nume">...</span>, Ã®n conformitate cu Contractul de furnizare nr. 143/06.12.2024, Ã®ncheiat Ã®ntre Liceul Tehnologic â€Victor MihÄƒilescu Craiuâ€ BelceÈ™ti È™i SC PROCONS IASI SRL È™i Nota de comandÄƒ nr. <input type="text" style="width:40px; border-bottom:1px dotted #000; border-top:none; border-left:none; border-right:none; text-align:center;"> / <input type="text" style="width:90px; border-bottom:1px dotted #000; border-top:none; border-left:none; border-right:none;">.</p>
    
    <p class="alineat">Comisia de recepÈ›ie a procedat astÄƒzi, <input type="text" class="input-data" placeholder="__.__.2025">, la inventarierea avizelor de Ã®nsoÈ›ire a pachetului alimentar, dupÄƒ cum urmeazÄƒ:</p>

    <table class="data-table">
        <thead>
            <tr><th class="col-nr">Nr.</th><th class="col-data">Data</th><th class="col-spec">Tip meniu È™i specificaÈ›ii</th><th class="col-portii">PorÈ›ii Primite</th><th class="col-portii">PorÈ›ii Aviz</th></tr>
        </thead>
        <tbody id="tbody-pv"></tbody>
    </table>

    <div class="section-signatures">
        <p class="alineat">Comisia de recepÈ›ie constatÄƒ cÄƒ pachetele alimentare de tip masÄƒ caldÄƒ au fost furnizate Ã®n conformitate cu specificaÈ›iile tehnice, cantitÄƒÈ›ile È™i perioada stipulate Ã®n contract.</p>
        <p class="alineat">Comisia de receptie constatÄƒ cÄƒ furnizorul È™i-a respectat obligaÈ›iile stabilite prin contract. Valoarea bunurilor corespunde cu preÈ›ul stabilit Ã®n contractul de furnizare semnat Ã®ntre pÄƒrÈ›i.</p>
        <p class="alineat">Procesul verbal conÈ›ine 2 pagini È™i a fost semnat astÄƒzi, <input type="text" class="input-data">, la sediul achizitorului, Ã®n douÄƒ exemplare.</p>

        <div class="comisie-centrata">
            <p><strong>Beneficiar:</strong> Liceul Tehnologic â€Victor MihÄƒilescu Craiuâ€ BelceÈ™ti</p>
            <p style="margin-top:15px; margin-bottom:10px;"><strong>Comisia de recepÈ›ie:</strong></p>
            
            <div class="membru-pv">1. prof. dr. Ciprian MIHAI<div class="linie-semnatura"></div></div>
            <div class="membru-pv">2. Pavel Ioan<div class="linie-semnatura"></div></div>
            <div class="membru-pv">3. prof. Scutaru Gabriela<div class="linie-semnatura"></div></div>
        </div>
    </div>
    <div class="footer-content">â€PNRR. FinanÈ›at de Uniunea EuropeanÄƒ â€“ UrmÄƒtoareaGeneraÈ›ieUEâ€<br>https://mfe.gov.ro/pnrr/</div>
</div>

<script>
    const URL_S = 'https://aexjrbdgajurxzngfkpx.supabase.co';
    const KEY_S = 'sb_publishable_KPV__0BA9z4EvRl5eqC0FQ_hmBLOLYv';
    const supabaseClient = supabase.createClient(URL_S, KEY_S);

    const params = new URLSearchParams(window.location.search);
    const luna = params.get('luna'), an = params.get('an');
    const luniMapping = { "Ianuarie":"01","Februarie":"02","Martie":"03","Aprilie":"04","Mai":"05","Iunie":"06","Iulie":"07","August":"08","Septembrie":"09","Octombrie":"10","Noiembrie":"11","Decembrie":"12" };

    const meniuriConfig = {
        1: "<strong>Meniu 1: È˜niÈ›el de pui</strong> (È˜niÈ›el >130g, GarniturÄƒ cartofi/piure >150g, SalatÄƒ varzÄƒ, 3 felii pÃ¢ine, TacÃ¢muri)",
        2: "<strong>Meniu 2: PulpÄƒ de pui</strong> (PulpÄƒ >130g, GarniturÄƒ orez/cartofi >150g, SalatÄƒ varzÄƒ/asortatÄƒ, 3 felii pÃ¢ine, TacÃ¢muri)",
        3: "<strong>Meniu 3: Hamburger pui</strong> (Burger >130g, GarniturÄƒ cartofi pai >150g, Legume, ChiflÄƒ, TacÃ¢muri)",
        4: "<strong>Meniu 4: Piept de pui</strong> (Piept >130g, GarniturÄƒ natur/piure >150g, SalatÄƒ varzÄƒ/asortatÄƒ, 3 felii pÃ¢ine, TacÃ¢muri)",
        5: "<strong>Meniu 5: MÃ¢ncare cartofi cu porc</strong> (Carne porc >130g, MÃ¢ncÄƒricÄƒ cartofi >150g, MurÄƒturi asortate, 3 felii pÃ¢ine, TacÃ¢muri)"
    };

    async function incarcaDate() {
        document.querySelectorAll('.luna-nume').forEach(el => el.innerText = luna);
        document.querySelectorAll('.an-nume').forEach(el => el.innerText = an);
        document.querySelectorAll('.luna-text-mic').forEach(el => el.innerText = luna.toLowerCase());

        const { data: records } = await supabaseClient.from('setari_pontaj').select('*').match({ luna: luna, an: an }).order('zi', { ascending: true });

        if (records) {
            let index = 1, rowsHtml = "";
            const activeRecords = records.filter(r => r.valoare_aviz > 0);
            
            activeRecords.forEach((row, i) => {
                const ziF = String(row.zi).padStart(2, '0');
                const dataF = `${ziF}.${luniMapping[luna]}.${an}`;
                const isLast = (i === activeRecords.length - 1) ? 'class="keep-with-next"' : '';
                
                rowsHtml += `<tr ${isLast}><td>${index++}</td><td>${dataF}</td><td class="col-spec">${meniuriConfig[row.tip_meniu] || "Meniu"}</td><td>${row.valoare_aviz}</td><td>${row.valoare_aviz}</td></tr>`;
            });
            
            document.getElementById('tbody-raport').innerHTML = rowsHtml;
            document.getElementById('tbody-pv').innerHTML = rowsHtml;
        }
    }
    incarcaDate();
</script>
</body>
</html>